<div class="modal-overlay">
  <div class="modal-content">
    <div
      class="modal-header d-flex flex-column align-items-center justify-content-center position-relative"
      [ngClass]="{ 'border-bottom-0': isFormVisible }"
    >
      <div *ngIf="!isFormVisible" class="text-center">
        <img
          src="assets/img/av1.jpg"
          alt="Profile"
          class="rounded-circle mb-3"
          style="width: 80px; height: 80px; object-fit: cover; display: block; margin: 0 auto;"
        />

        <h5 class="modal-title mt-2" id="selectPageModalLabel" style="color: white;">
          This Profile Is For
        </h5>
      </div>

      <button
        *ngIf="!isFormVisible"
        type="button"
        class="btn-close"
        aria-label="Close"
        (click)="closeModal()"
        style="position: absolute; right: 20px; top: 15px;"
      ></button>
    </div>

    <div class="modal-body text-center">
      <!-- User Type Chips -->
      <div *ngIf="!isFormVisible" class="d-flex flex-wrap justify-content-start gap-2 mb-4">

        <label class="btn btn-light text-dark rounded-pill custom-chip">
          <input type="radio" name="userType" (change)="showGenderChips('Myself')" class="radio-input" /> Myself
        </label>

        <label class="btn btn-light text-dark rounded-pill custom-chip">
          <input type="radio" name="userType" (change)="showGenderChips('My Son')" class="radio-input" /> My Son
        </label>

        <label class="btn btn-light text-dark rounded-pill custom-chip">
          <input type="radio" name="userType" (change)="showGenderChips('My Daughter')" class="radio-input" /> My Daughter
        </label>

        <label class="btn btn-light text-dark rounded-pill custom-chip">
          <input type="radio" name="userType" (change)="showGenderChips('My Brother')" class="radio-input" /> My Brother
        </label>

        <label class="btn btn-light text-dark rounded-pill custom-chip">
          <input type="radio" name="userType" (change)="showGenderChips('My Sister')" class="radio-input" /> My Sister
        </label>

        <label class="btn btn-light text-dark rounded-pill custom-chip">
          <input type="radio" name="userType" (change)="showGenderChips('My Friend')" class="radio-input" /> My Friend
        </label>

        <label class="btn btn-light text-dark rounded-pill custom-chip">
          <input type="radio" name="userType" (change)="showGenderChips('My Relative')" class="radio-input" /> My Relative
        </label>

      </div>

      <!-- Gender Chips Section -->
      <div *ngIf="isGenderChipsVisible && !isFormVisible" class="mt-4 text-start">
        <h5 class="text-dark mb-3">{{ genderHeading }}</h5>

        <div class="d-flex flex-wrap gap-2">
          <label class="btn btn-light text-dark rounded-pill custom-chip">
            <input type="radio" name="gender" value="Male" class="radio-input" (change)="selectGender('Male')" /> Male
          </label>

          <label class="btn btn-light text-dark rounded-pill custom-chip">
            <input type="radio" name="gender" value="Female" class="radio-input" (change)="selectGender('Female')" /> Female
          </label>
        </div>
      </div>

      <!-- Continue Button -->
      <div *ngIf="isContinueButtonVisible && !isGenderChipsVisible" class="mt-4">
        <button class="btn-danger-red" (click)="continueToForm()">Continue</button>
      </div>

      <!-- Form Section -->
      <div *ngIf="isFormVisible" class="mt-4 mx-auto" style="max-width: 350px;">

        <!-- Back Button -->
        <button
          type="button"
          class="btn position-absolute start-0 ms-3 mb-3 border-0 bg-transparent text-white"
          (click)="goBack()"
        >
          <i class="bi bi-arrow-left-circle fs-3 text-white"></i>
        </button>

        <form [formGroup]="userForm" (ngSubmit)="saveUser()">

          <!-- Profile Image -->
          <div class="mb-3 text-center position-relative d-inline-block">
            <img
              [src]="selectedImage"
              class="rounded-circle mb-3 border border-2 border-secondary"
              style="width: 80px; height: 80px; object-fit: cover;"
            />

            <input
              type="file"
              accept="image/*"
              class="d-none"
              #fileInput
              (change)="onImageSelected($event)"
            />

            <button
              type="button"
              class="btn btn-light border position-absolute p-1 d-flex align-items-center justify-content-center shadow-sm rounded-circle"
              style="bottom: 10px; right: 5px; width: 28px; height: 28px;"
              (click)="onEditImageClick(fileInput)"
            >
              <i class="bi bi-pencil-fill text-danger fs-6"></i>
            </button>
          </div>

          <h5 class="text-dark mb-3 fw-semibold">{{ formHeading }}</h5>

          <div class="mb-3">
            <input formControlName="firstName" type="text" class="form-control" placeholder="First Name" />
          </div>

          <div class="mb-3">
            <input formControlName="lastName" type="text" class="form-control" placeholder="Last Name" />
          </div>

          <div class="mb-3">
            <input formControlName="mobileNo" type="tel" maxlength="10" class="form-control" placeholder="Mobile Number" />
          </div>

          <h5 class="text-dark mb-2 fw-semibold">Date of Birth</h5>
          <div class="mb-3">
            <input formControlName="dob" type="date" class="form-control" />
          </div>

          <div class="mb-3">
            <input formControlName="email" type="email" class="form-control" placeholder="Email" />
          </div>

          <div class="mb-3">
            <input formControlName="password" type="password" class="form-control" placeholder="Password" />
          </div>

          <button type="submit" class="btn btn-danger px-4 py-2 w-100">Save</button>
        </form>
      </div>
    </div>
  </div>
</div>
